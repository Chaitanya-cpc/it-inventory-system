{% extends 'base.html' %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
  <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
      <h1 class="h2">{{ title }}</h1>
      <div class="btn-toolbar mb-2 mb-md-0">
        <a href="{{ url_for('main.hardware_add') }}" class="btn btn-success">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-plus-lg" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2Z"/></svg>
          Add New Hardware
        </a>
      </div>
    </div>

   <div class="row mb-3">
      <div class="col-md-6 offset-md-6">
         <form method="get" action="{{ url_for('main.hardware_list') }}">
              <div class="input-group">
                  <input type="search" class="form-control" placeholder="Search by name or serial..." name="search" value="{{ search_term or '' }}">
                  <button class="btn btn-outline-secondary" type="submit">Search</button>
                  {% if search_term %}
                     <a href="{{ url_for('main.hardware_list') }}" class="btn btn-outline-danger" title="Clear Search">Ã—</a>
                  {% endif %}
              </div>
          </form>
      </div>
  </div>


  <div class="table-responsive">
    <table class="table table-striped table-hover table-sm">
      <thead>
        <tr>
          <th>ID</th>
          <th>Name</th>
          <th>Category</th>
          <th>Status</th>
          <th>Serial Number</th>
          <th>Assigned User</th>
          <th>Location</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% if assets %}
          {% for asset in assets %}
          <tr>
            <td>{{ asset.id }}</td>
            <td><a href="{{ url_for('main.hardware_view', asset_id=asset.id) }}">{{ asset.name }}</a></td>
            <td>{{ asset.category or 'N/A' }}</td>
            <td><span class="badge bg-{{ 'success' if asset.status == 'Okay' or asset.status == 'Deployed' else 'secondary' if asset.status == 'New' or asset.status == 'Stored' else 'warning' if asset.status == 'Needs Repair' else 'danger' if asset.status == 'Dead' else 'light' }}">{{ asset.status or 'N/A' }}</span></td>
            <td>{{ asset.serial_number or 'N/A' }}</td>
            <td>{{ asset.assigned_user or 'N/A' }}</td>
            <td>{{ asset.location or 'N/A' }}</td>
            <td>
                <a href="{{ url_for('main.hardware_view', asset_id=asset.id) }}" class="btn btn-sm btn-outline-info" title="View"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye" viewBox="0 0 16 16"><path d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8zM1.173 8a13.133 13.133 0 0 1 1.618-3.224l-.937.643A14.28 14.28 0 0 0 .92 7.76a.5.5 0 0 0 0 .48A14.28 14.28 0 0 0 1.855 9.58l.937.644A13.133 13.133 0 0 1 1.173 8zm13.654 0a13.133 13.133 0 0 1-1.618 3.224l.937-.643A14.28 14.28 0 0 0 15.08 8.24a.5.5 0 0 0 0-.48 14.28 14.28 0 0 0-.735-1.58l-.937-.644A13.133 13.133 0 0 1 14.827 8zM8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5z"/><path d="M12.5 8a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0zM8 3.5a4.5 4.5 0 1 1 0 9 4.5 4.5 0 0 1 0-9z"/></svg></a>
                <a href="{{ url_for('main.hardware_edit', asset_id=asset.id) }}" class="btn btn-sm btn-outline-warning" title="Edit"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil-square" viewBox="0 0 16 16"><path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.793l-2.03-2.03L13.52.692a.5.5 0 0 1 .707 0l1.273 1.248zm-4.386 3.251l-2.03-2.03L.99 8.716a.5.5 0 0 0 0 .707l2.03 2.03a.5.5 0 0 0 .707 0L11.116 5.19z"/><path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"/></svg></a>
                <!-- Delete Button (use a form for POST) -->
                <form action="{{ url_for('main.hardware_delete', asset_id=asset.id) }}" method="post" style="display: inline;" onsubmit="return confirm('Are you sure you want to delete asset \'{{ asset.name }}\'? This cannot be undone.');">
                   <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/> {# CSRF Token #}
                   <button type="submit" class="btn btn-sm btn-outline-danger" title="Delete"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash3" viewBox="0 0 16 16"><path d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5ZM11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H2.506a.58.58 0 0 0-.01 0H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1h-.995a.59.59 0 0 0-.01 0H11Zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5h9.916Zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm2.983-.01a.5.5 0 0 1 .55.466l.5 8.5a.5.5 0 1 1-.998 0l-.5-8.5a.5.5 0 0 1 .448-.504Zm2.993.01a.5.5 0 0 1 .533.46l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .465-.512Z"/></svg></button>
                </form>
            </td>
          </tr>
        {% endfor %}
        {% else %}
          <tr>
            <td colspan="8" class="text-center">
                {% if search_term %}
                    No hardware assets found matching your search. <a href="{{ url_for('main.hardware_list') }}">Clear search</a>.
                {% else %}
                     No hardware assets found. <a href="{{ url_for('main.hardware_add') }}">Add one now</a>.
                {% endif %}
            </td>
          </tr>
        {% endif %}
      </tbody>
    </table>
  </div> {# end table-responsive #}

{% endblock %}